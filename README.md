**Grafana to Matrix Forwarder**

Webserver to forward alerts from [Grafana](https://grafana.com) to a [Matrix](https://matrix.org) chat room.

 [![pipeline status](https://gitlab.com/hectorjsmith/grafana-matrix-forwarder/badges/main/pipeline.svg)](https://gitlab.com/hectorjsmith/grafana-matrix-forwarder/-/commits/main)

---

The purpose of this project is to provide a simple way to have alerts generated by Grafana to be forwarded to a Matrix room.

This works by setting up a Grafana alert channel to send a webhook to this application.
Once that webhook hits this tool, it will be converted into a message for Matrix and sent on to a specific room.

## Features

  * **Simple** to use and run. Packaged as a single binary, the tool is easy to run with minimal configuration.
  * Forward alerts to **custom rooms**. Include the room ID to send the alert to in the forward URL.
  * Support **multiple channels**. Multiple Grafana alert channels can be setup using the same forwarder instance. 
 
## How to use

**Run server**

Run the forwarder by providing a matrix account to send messages.

```
$ ./grafana-matrix-forwarder.bin --user @userId:matrix.org --password xxx --homeserver matrix.org
2020/11/22 18:10:01 starting matrix client ...
2020/11/22 18:10:02 starting webserver ...
2020/11/22 18:10:02 webserver listening at 0.0.0.0:6000
2020/11/22 18:10:02 ready
```

**Configure grafana**

Add a new **webhook** alert channel with the following URL: `http://<ip address>:6000/api/v0/forward?roomId=<roomId>`.

*Replace with the server ID and matrix room ID.*

**Usage documentation**

```
  -homeserver string
        url of the homeserver to connect to (default "matrix.org")
  -host string
        host address the server connects to (default "0.0.0.0")
  -password string
        password used to login to matrix
  -port int
        port to run the webserver on (default 6000)
  -user string
        username used to login to matrix
  -version
        show version info and exit

``` 

## Credits

Made possible by the [maunium.net/go/mautrix](https://maunium.net/go/mautrix/) library and all the contributors to the [matrix.org](https://matrix.org) protocol.
